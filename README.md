# AMPml
AMPml是使用python编写的抗菌肽预测软件。

## AMPml主要内容：

4种机器学习方法（随机森林、支持向量机、梯度上升、贝叶斯分类）

3种氨基酸特征转换方法（AAC（20）、PAAC（20+lambda）、CTDD（175））

现将软件编写过程中重要的步骤记录如下：

### 正训练集构建
1. 从 APD3 和 dbAMP数据库下载最新抗菌肽数据，合并2个数据库。
2. 根据序列最小长度为10，最大长度为100过滤数据集。
3. 删除序列中的X字符（X为任意氨基酸）。
4. 如果有相同序列，那只保留一个。
### 负训练集一构建
1. 从uniprot 网站下载最新（100）蛋白数据集。
2. 根据 R包 ampir文档 （https://github.com/Legana/AMP_pub/blob/master/02_build_training_data.md） 处理数据。
3. 根据序列最小长度为10，最大长度为150过滤数据集。
4. 删除序列中的X字符（X为任意氨基酸）。
### 负训练集二构建
如上。
5. 删除起始密码子编码的氨基酸（序列第一个M）。因为我们发现成熟的抗菌肽序列第一个氨基酸很少有 M，而从uniprot下载的序列都是完整的氨基酸序列（全部以M开头），这样的区别并不是我们
用来区别抗菌肽和非抗菌肽的特征，我们需要根据序列的理化性质或者是氨基酸组成来识别抗菌肽。也就是说这个 M 其实是一个扰乱信息。
### 训练
1. 根据文献和我们梯度尝试，正训练集：负训练集 = 1:3 准确性最高。
2. 根据结果，我们得到随机森林的准确度总是最高。
3. 根据网格搜索，当使用 CTDD 特征时，随机森林树木数量 = 111时，结果最准确，当使用 PAAC 特征时，随机森林树木数量=143时，结果最准确。而特征的选择在训练中无足轻重。

------------------------使用PAAC特征计算特征重要性：左图序列删除第一个M，右图不处理。----------------------------
![paac.jpg](https://i.loli.net/2020/11/24/Gm2xbs1niZNa5j4.jpg)

### 指标
RF+PAAC+去M训练:

accuracy: 0.944375

precision: 0.8883248730964467

recall: 0.8860759493670886

f1: 0.8871989860583016

Out-of-bag accuracy: 0.9394149933995692

Out-of-bag balanced accuracy: 0.92310748007037

AUC Score:0.9844550659173277

RF+PAAC+去M训练: 20000非抗菌肽序列（去M）准确率为 97.16%

RF+PAAC+去M训练: 20000非抗菌肽序列（不去M）准确率为 96.865%

RF+PAAC+去M训练: 2021抗菌肽序列准确率为 91.54%
